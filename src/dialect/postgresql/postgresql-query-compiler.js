"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PostgresQueryCompiler = void 0;
const default_query_compiler_js_1 = require("../../query-compiler/default-query-compiler.js");
const ID_WRAP_REGEX = /"/g;
class PostgresQueryCompiler extends default_query_compiler_js_1.DefaultQueryCompiler {
    #numParameters = 0;
    getCurrentParameterPlaceholder() {
        return '$' + ++this.#numParameters;
    }
    getLeftIdentifierWrapper() {
        return '"';
    }
    getRightIdentifierWrapper() {
        return '"';
    }
    getAutoIncrement() {
        // PostgreSQL uses SERIAL or GENERATED AS IDENTITY
        return 'generated by default as identity';
    }
    sanitizeIdentifier(identifier) {
        return identifier.replace(ID_WRAP_REGEX, '""');
    }
    visitValue(node) {
        if (node.value === null) {
            this.append('null');
        }
        else if (node.value === undefined) {
            this.append('null');
        }
        else if (typeof node.value === 'boolean') {
            this.append(node.value ? 'true' : 'false');
        }
        else {
            super.visitValue(node);
        }
    }
}
exports.PostgresQueryCompiler = PostgresQueryCompiler;
